# Домашнее задание к занятию 1.3 	REST API. HTTPs

### Цель задания

Импортировать Firebase SDK. Настроить Firebase на iOS с помощью CocoaPods. Аутентифицировать пользователей, научиться работать с облачным хранением данных с помощью Firebase API.

------

### Инструкция к выполнению домашнего задания

* За основу домашнего задания мы берем версию VK-проекта `Navigation` в рабочей ветке на Github. 
От локальной версии удаленной базовой ветки создайте новую ветку для ДЗ: `git checkout -b <название новой ветки>`. 
После окончания работы над ДЗ необходимо запушить ветку в origin.
* В поле для сдачи работы прикрепите ссылку на новый пулл реквест
* Любые вопросы по решению задач задавайте в чате учебной группы.

------

### Предварительная подготовка:
Взять за основу проект Navigation с LoginViewController. 
Подойдут ДЗ к лекции 3 (Паттерны и архитектура), 4 (MVVM + координаторы) и далее. 
Основное предварительное условие: готовый `LoginViewController`

------

### Задача: 

1. Создать свой проект в [Firebase](https://firebase.google.com/docs/ios/setup).
2. Зарегистрировать приложение в Firebase, введя Bundle Identifier.
3. По инструкции .plist -> скачать из консоли Firebase и добавить в файлы приложения, сконфигурируйте `FirebaseApp` в `AppDelegate`.
4. Установить Firebase/Core, Firebase/Auth через [CocoaPods](https://cocoapods.org).
5. Подключить Firebase/Auth к LoginViewController.
https://firebase.google.com/docs/auth/ios/start?authuser=0

------

### Сценарии "Регистрация" и "Вход" 

1. Перед тем, как писать код, проработать сценарии:  
   a) юзер вводит корректные email / пароль, которых еще в БД нет - зарегистрировать нового юзера  
   b) юзер пытается войти с пустыми полями ввода (может быть кнопке `Login` сделать ***disable?***) - напомнить о том, что надо ввести email и пароль  
   c) юзер нажимает кнопку `Login` с частично/неверно заполненными полями ввода - выдать ошибку  
   d) юзер вводит корректные email / пароль, которые уже существуют в базе - успешный логин  
   
2. Реализовать `CheckerService` как Core-компонент - компонент, взаимодействующий с БД. 
- Закрыть его протоколом `CheckerServiceProtocol`. 
- Протокол будет требовать пару методов - `checkCredentials` и `signUp`, которые будут вызываться по нажатии на кнопки `Login` и `Sign Up` соответственно. 
- При реализации метода `checkCredentials` проверять, есть ли в БД пользователь с переданными учетными данными, вызывая метод `Auth.auth().signIn(withEmail:, password:, completion:)`. 
- Если данный метод вернул ошибку, то показывать ее на экране в виде алерта. Регистрировать пользователя с помощью метода `Auth.auth().createUser(withEmail:, password:, completion:)`. 
- Если на экране отрисована лишь одна кнопка `Login`, то необходимо продумать логику регистрации пользователя. При нажатии на нее сначала проверять, есть ли такой пользователь в БД:
   - Если такого пользователя нет, регистировать в БД. 
   - Если такой пользователь есть, но введен неверный пароль, показать соответствующую ошибку. 
   - Если пользователь есть, а введенные поля валидны, проходить авторизацию и открывать следующий экран.

3. При закрытии приложения не забыть пользователя разлогинить с помощью метода `Auth.auth().signOut()` в методе `AppDelegate/SceneDelegate` `applicationWillTerminate/sceneDidDisconnect`.

4. Вызывать методы `CheckerService` в сервисе/инспекторе `LoginInspector`, который закрыт протоколом `LoginViewControllerDelegate` и который инджектится в `LoginViewController`. `LoginViewControllerDelegate` требует те же методы, что и `CheckerServiceProtocol`. Получается `LoginViewController` имеет ссылку на `LoginInspector` в виде приватного свойства `private weak var delegate: LoginViewControllerDelegate?`. При нажатии на кнопки/кнопку, в реализации соответствующих функций/соответствующей функции, вызываются методы делегата `checkCredentials` или `signUp`.

------

### Что пригодится: 

`FirebaseAuth.Auth.auth().currentUser` - проверка на `nil`

`FirebaseAuth.Auth.auth().createUser(withEmail:, password:, completion:)`

`FirebaseAuth.Auth.auth().signIn(withEmail:, password:, completion:)`

`FirebaseAuth.Auth.auth().signOut() throws`

------

### Правила приема домашнего задания

В личном кабинете отправлены:

- ссылка на Pull Request с выполненной работой.

### Критерии оценки

Зачет - выполнены все задания, ответы даны в развернутой форме, приложены соответствующие файлы проекта, в выполненных заданиях нет противоречий и нарушения логики.

На доработку - задание выполнено частично или не выполнено, в логике выполнения заданий есть противоречия, существенные недостатки.
